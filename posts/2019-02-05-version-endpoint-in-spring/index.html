<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=theme-color content="#494f5c"><meta name=msapplication-TileColor content="#494f5c"><meta itemprop=name content="Version endpoint in Spring Boot"><meta itemprop=description content="When generating your Spring Boot project using Spring Initializr, you already have the spring-boot-maven-plugin plugin in your Maven pom.xmlfile.
Generating build info is done by adding the build-info goal. This results in a /META-INF/build-info.properties file in your resulting package. By default this contains group id, artifact, buildtime and version of the project.
Off course you can add additional properties in the additionalProperties element. Just like you define properties in any Maven section."><meta itemprop=datePublished content="2019-02-05T22:48:21+00:00"><meta itemprop=dateModified content="2019-02-05T22:48:21+00:00"><meta itemprop=wordCount content="367"><meta itemprop=keywords content="Spring Boot,"><meta property="og:title" content="Version endpoint in Spring Boot"><meta property="og:description" content="When generating your Spring Boot project using Spring Initializr, you already have the spring-boot-maven-plugin plugin in your Maven pom.xmlfile.
Generating build info is done by adding the build-info goal. This results in a /META-INF/build-info.properties file in your resulting package. By default this contains group id, artifact, buildtime and version of the project.
Off course you can add additional properties in the additionalProperties element. Just like you define properties in any Maven section."><meta property="og:type" content="article"><meta property="og:url" content="http://www.pieterjd.be/posts/2019-02-05-version-endpoint-in-spring/"><meta property="article:published_time" content="2019-02-05T22:48:21+00:00"><meta property="article:modified_time" content="2019-02-05T22:48:21+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Version endpoint in Spring Boot"><meta name=twitter:description content="When generating your Spring Boot project using Spring Initializr, you already have the spring-boot-maven-plugin plugin in your Maven pom.xmlfile.
Generating build info is done by adding the build-info goal. This results in a /META-INF/build-info.properties file in your resulting package. By default this contains group id, artifact, buildtime and version of the project.
Off course you can add additional properties in the additionalProperties element. Just like you define properties in any Maven section."><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><title>Version endpoint in Spring Boot</title><link rel=stylesheet href=http://www.pieterjd.be/css/style.min.657bcb7af31123e4156b1a3d2ff60a636717e54ead74f882136b5114cf72b55e.css integrity="sha256-ZXvLevMRI+QVaxo9L/YKY2cX5U6tdPiCE2tRFM9ytV4=" crossorigin=anonymous><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-132459675-1','auto');ga('send','pageview');}</script></head><body id=page><header id=site-header class="animated slideInUp faster"><div class="hdr-wrapper section-inner"><div class=hdr-left><div class=site-branding><a href=http://www.pieterjd.be>pieterjd.be</a></div><nav class="site-nav hide-in-mobile"><a href=http://www.pieterjd.be/posts/>Posts</a>
<a href=http://www.pieterjd.be/series/>Series</a>
<a href=http://www.pieterjd.be/talks/>Talks</a>
<a href=http://www.pieterjd.be/about/>About</a></nav></div><div class="hdr-right hdr-icons"><span class="hdr-social hide-in-mobile"><a href=https://www.linkedin.com/in/pieterjandrouillon/ target=_blank rel="noopener me" title=Linkedin><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a><a href=https://github.com/pieterjd target=_blank rel="noopener me" title=Github><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></span><button id=menu-btn class=hdr-btn title=Menu><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div></div></header><div id=mobile-menu class="animated fast"><ul><li><a href=http://www.pieterjd.be/posts/>Posts</a></li><li><a href=http://www.pieterjd.be/series/>Series</a></li><li><a href=http://www.pieterjd.be/talks/>Talks</a></li><li><a href=http://www.pieterjd.be/about/>About</a></li></ul></div><main class="site-main section-inner animated fadeIn faster"><article class=thin><header class=post-header><div class=post-meta><span>Feb 5, 2019</span></div><h1>Version endpoint in Spring Boot</h1></header><div class=content><p>When generating your Spring Boot project using <a href=https://start.spring.io/>Spring Initializr</a>, you already have the <code>spring-boot-maven-plugin</code> plugin in your Maven <code>pom.xml</code>file.</p><p>Generating build info is done by adding the <code>build-info</code> goal. This results in a <code>/META-INF/build-info.properties</code> file in your resulting package. By default this contains group id, artifact, buildtime and version of the project.</p><p>Off course you can add additional properties in the <code>additionalProperties</code> element. Just like you define properties in any Maven section.</p><p>Below is the relevant snippet from a Spring Boot application. It contains</p><ul><li>the <code>spring-boot-maven-plugin</code>definition</li><li>the <code>build-info</code>goal</li><li>additional properties such as application name and application description. You can add as many as you like</li></ul><div class=highlight><pre class=chroma><code class=language-xml data-lang=xml><span class=nt>&lt;build&gt;</span>
   <span class=nt>&lt;plugins&gt;</span>
      <span class=nt>&lt;plugin&gt;</span>
         <span class=nt>&lt;groupId&gt;</span>org.springframework.boot<span class=nt>&lt;/groupId&gt;</span>
         <span class=nt>&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class=nt>&lt;/artifactId&gt;</span>
         <span class=nt>&lt;executions&gt;</span>
            <span class=nt>&lt;execution&gt;</span>
               <span class=nt>&lt;goals&gt;</span>
                  <span class=nt>&lt;goal&gt;</span>build-info<span class=nt>&lt;/goal&gt;</span>
               <span class=nt>&lt;/goals&gt;</span>
               <span class=nt>&lt;configuration&gt;</span>
                  <span class=nt>&lt;additionalProperties&gt;</span>
                     <span class=nt>&lt;java.source&gt;</span>${maven.compiler.source}<span class=nt>&lt;/java.source&gt;</span>
                     <span class=nt>&lt;java.version&gt;</span>${java.version}<span class=nt>&lt;/java.version&gt;</span>
                     <span class=nt>&lt;application.name&gt;</span>${project.name}<span class=nt>&lt;/application.name&gt;</span>
                     <span class=nt>&lt;application.description&gt;</span>${project.description}<span class=nt>&lt;/application.description&gt;</span>
                  <span class=nt>&lt;/additionalProperties&gt;</span>
               <span class=nt>&lt;/configuration&gt;</span>
            <span class=nt>&lt;/execution&gt;</span>
         <span class=nt>&lt;/executions&gt;</span>
      <span class=nt>&lt;/plugin&gt;</span>
   <span class=nt>&lt;/plugins&gt;</span>
<span class=nt>&lt;/build&gt;</span>
</code></pre></div><p>Next part is to read this properties file. Thank god for <a href=https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/info/BuildProperties.html><code>BuildProperties</code></a> . Spring Boot also creates a Bean when starting an application, so you can just auto wire it to a field.</p><p>Only downside is that this class is not related to the default <code>java.util.Properties</code>class. So you have to create an intermediate <code>Properties</code>object and copy all (key,value) pairs from the buildProperties to the property object you want to return. This is required as the <code>BuildProperties</code>class does not define getters for custom properties</p><p>The <code>time</code>property had to be transformed to a String as the default <code>Instant</code>does not map properly to json.</p><p>If you put all things together, you get the following controller.</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=nd>@RestController</span>
<span class=nd>@RequestMapping</span><span class=o>(</span><span class=s>&#34;/version&#34;</span><span class=o>)</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>BuildInfoController</span> <span class=o>{</span>
    <span class=nd>@Autowired</span>
    <span class=kd>private</span> <span class=n>BuildProperties</span> <span class=n>buildProperties</span><span class=o>;</span>

    <span class=nd>@GetMapping</span>
    <span class=kd>public</span> <span class=n>Properties</span> <span class=nf>getInfo</span><span class=o>()</span> <span class=o>{</span>
        <span class=n>Properties</span> <span class=n>prop</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Properties</span><span class=o>();</span>
        <span class=c1>//need to explicitly loop over all entries, just returning the BuildProperties object only contains the specific fields (artificact, group, name, time and version)
</span><span class=c1></span>        <span class=n>buildProperties</span><span class=o>.</span><span class=na>forEach</span><span class=o>(</span><span class=n>entry</span> <span class=o>-&gt;</span> <span class=n>prop</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=n>entry</span><span class=o>.</span><span class=na>getKey</span><span class=o>(),</span><span class=n>entry</span><span class=o>.</span><span class=na>getValue</span><span class=o>()));</span>
        <span class=c1>//proper date formatting for time
</span><span class=c1></span>        <span class=n>prop</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=s>&#34;time&#34;</span><span class=o>,</span> <span class=n>Instant</span><span class=o>.</span><span class=na>ofEpochMilli</span><span class=o>(</span><span class=n>Long</span><span class=o>.</span><span class=na>parseLong</span><span class=o>(</span><span class=n>prop</span><span class=o>.</span><span class=na>getProperty</span><span class=o>(</span><span class=s>&#34;time&#34;</span><span class=o>))).</span><span class=na>toString</span><span class=o>());</span>
        <span class=k>return</span> <span class=n>prop</span><span class=o>;</span>
    <span class=o>}</span>
<span class=o>}</span>
</code></pre></div><p>Now you can run the application and do a request for <code>localhost:8080/version</code>, and this results in the following json:</p><div class=highlight><pre class=chroma><code class=language-json data-lang=json><span class=p>{</span>  
   <span class=nt>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;ta&#34;</span><span class=p>,</span>
   <span class=nt>&#34;java.version&#34;</span><span class=p>:</span><span class=s2>&#34;1.8&#34;</span><span class=p>,</span>
   <span class=nt>&#34;time&#34;</span><span class=p>:</span><span class=s2>&#34;2019-02-05T13:13:48.282Z&#34;</span><span class=p>,</span>
   <span class=nt>&#34;application.description&#34;</span><span class=p>:</span><span class=s2>&#34;Demo project for Spring Boot&#34;</span><span class=p>,</span>
   <span class=nt>&#34;application.name&#34;</span><span class=p>:</span><span class=s2>&#34;ta&#34;</span><span class=p>,</span>
   <span class=nt>&#34;version&#34;</span><span class=p>:</span><span class=s2>&#34;0.0.1-SNAPSHOT&#34;</span><span class=p>,</span>
   <span class=nt>&#34;java.source&#34;</span><span class=p>:</span><span class=s2>&#34;1.8&#34;</span><span class=p>,</span>
   <span class=nt>&#34;group&#34;</span><span class=p>:</span><span class=s2>&#34;com.example.edev.ott&#34;</span><span class=p>,</span>
   <span class=nt>&#34;artifact&#34;</span><span class=p>:</span><span class=s2>&#34;ta&#34;</span>
<span class=p>}</span>
</code></pre></div><h2 id=summary>Summary<a href=#summary class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>To conclude: only two steps required for a version endpoint:</p><ol><li>configure Maven and add your custom properties if required</li><li>create a RestController, auto-wire BuildProperties and transform it to <code>java.util.properties</code> , <code>Map</code> or whatever you want</li></ol></div><hr class=post-end><footer class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=http://www.pieterjd.be/tags/spring-boot>Spring Boot</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>367 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2019-02-05 22:48 +0000</p></footer></article><div class="post-nav thin"><a class=next-post href=http://www.pieterjd.be/posts/2019-03-31-streams-part1-collectors/><span class=post-nav-label><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>&nbsp;Newer</span><br><span>Stream examples Part 1 - Collectors</span></a>
<a class=prev-post href=http://www.pieterjd.be/posts/2019-01-21-font-awesome-with-jhipster/><span class=post-nav-label>Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg></span><br><span>Font Awesome with JHipster</span></a></div><div id=comments class=thin></div></main><footer id=site-footer class="section-inner thin animated fadeIn faster"><p>&copy; 2021 <a href=http://www.pieterjd.be>Pieter-Jan Drouillon</a> &#183; <a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>CC BY-NC 4.0</a></p><p>Made with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> &#183; Theme <a href=https://github.com/Track3/hermit target=_blank rel=noopener>Hermit</a> &#183; <a href=http://www.pieterjd.be/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></p></footer><script src=http://www.pieterjd.be/js/bundle.min.4a9a0ac3d2217822c7865b4161e6c2a71de1d70492264337755427898dd718f6.js integrity="sha256-SpoKw9IheCLHhltBYebCpx3h1wSSJkM3dVQniY3XGPY=" crossorigin=anonymous></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-132459675-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>