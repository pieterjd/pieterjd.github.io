<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Summarize Latest Changes In Your Codebase | pieterjd.be</title>
<meta name=keywords content>
<meta name=description content="You are probably familiar with this workflow
 work on different stories pull requests are approved and merged deploy changes inform the team  For the last part, you check your todo list to get a nice description instead of some mysterious ID. You could do this manually, but this is very time-consuming, not to mention mind-numbing. Scripts to the rescue!
High level approach   Fetch the version information of the environment you want to deploy to.">
<meta name=author content>
<link rel=canonical href=https://www.pieterjd.be/posts/summarize-latest-changes-in-your-codebase/>
<meta name=google-site-verification content="MN3Sf5TrdFo5j8qHAiXG2_gF0P1tXmClJN0JX8TvqgU">
<link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.pieterjd.be/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://www.pieterjd.be/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://www.pieterjd.be/favicon-32x32.png>
<link rel=apple-touch-icon href=https://www.pieterjd.be/apple-touch-icon.png>
<link rel=mask-icon href=https://www.pieterjd.be/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-132459675-1','auto'),ga('send','pageview'))</script><meta property="og:title" content="Summarize Latest Changes In Your Codebase">
<meta property="og:description" content="You are probably familiar with this workflow
 work on different stories pull requests are approved and merged deploy changes inform the team  For the last part, you check your todo list to get a nice description instead of some mysterious ID. You could do this manually, but this is very time-consuming, not to mention mind-numbing. Scripts to the rescue!
High level approach   Fetch the version information of the environment you want to deploy to.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://www.pieterjd.be/posts/summarize-latest-changes-in-your-codebase/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-06-27T12:33:00+02:00">
<meta property="article:modified_time" content="2022-07-31T11:58:12+02:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Summarize Latest Changes In Your Codebase">
<meta name=twitter:description content="You are probably familiar with this workflow
 work on different stories pull requests are approved and merged deploy changes inform the team  For the last part, you check your todo list to get a nice description instead of some mysterious ID. You could do this manually, but this is very time-consuming, not to mention mind-numbing. Scripts to the rescue!
High level approach   Fetch the version information of the environment you want to deploy to.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://www.pieterjd.be/posts/"},{"@type":"ListItem","position":3,"name":"Summarize Latest Changes In Your Codebase","item":"https://www.pieterjd.be/posts/summarize-latest-changes-in-your-codebase/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Summarize Latest Changes In Your Codebase","name":"Summarize Latest Changes In Your Codebase","description":"You are probably familiar with this workflow\n work on different stories pull requests are approved and merged deploy changes inform the team  For the last part, you check your todo list to get a nice description instead of some mysterious ID. You could do this manually, but this is very time-consuming, not to mention mind-numbing. Scripts to the rescue!\nHigh level approach   Fetch the version information of the environment you want to deploy to.","keywords":[],"articleBody":"You are probably familiar with this workflow\n work on different stories pull requests are approved and merged deploy changes inform the team  For the last part, you check your todo list to get a nice description instead of some mysterious ID. You could do this manually, but this is very time-consuming, not to mention mind-numbing. Scripts to the rescue!\nHigh level approach   Fetch the version information of the environment you want to deploy to. If not yet available, I suggest you create a version endpoint and include the commit id of the lastest commit. If you work with the Java/Maven combo, then just include the Git Commit ID Maven Plugin\n  Get all information from all commits starting from the commit id, retrieved from the version id up till the last one. Assuming you use git (and you should!) then you can use the following command\ngit log ..HEAD --format=format:\"%s\"   Do some regex magic to extract the story id, task id, ….\n  Connect to your backlog (REST, commandline, ….) to retrieve the information of the story id\n  print on the console and copy to clipboard\n  Example script As I am a fan of powershell, this was my go to language to implement this workflow.\n# --- helper functions --- # get all commit messages starting from the given hash function get-commits($fromHash){ $commits = \u0026 \"git\" @(\"log\",\"$fromHash..HEAD\", \"--format=format:\"\"%s\"\"\") return $commits } # $ticketId: the Jira ticket id # $prefix: prefix for the message that will be returned - empty by default function get-description($ticketId,$prefix=''){ $url = \"https:///rest/api/2/search?jql=issue={0}\u0026fields=summary,parent\" -f $ticketId $response = (curl -u your credential $url -s) | ConvertFrom-json $summary = $response.issues.fields | select -ExpandProperty summary return \"{0}{1} - {2}\" -f $prefix,$ticketId,$summary } # Step 1: get version endpoint and get the hash of the latest deployed commit $shortCommitId = (Invoke-RestMethod https://replace with your own endpoint/version).gitHash # Step 2: pull in latest changes and get all commit messages git checkout develop git pull $commits = get-commits($shortCommitId) # step 3: keep commit messages containing qntc, the Jira project key $commits = $commits |?{$_ -like '*qntc*'} # start building the message as an array of strings $msg = @(\"Starting deploy to int. Deploy includes: \") # Step 4: retrieve the story description # typical powershell one-liner: # - Loop over all commits and check for QNTC prefix # - Sort the found prefixes # - Select the unique values # - Fetch the story description for each unique value # the array of the unique story description is prefixed with '* ', and are then appended to the $msg array $msg += ($commits |%{if($_ -match 'QNTC[SUP]*-\\d+') {$Matches[0]}} | sort| select -unique | %{get-description $_ '* '}) # copy the message to the clipboard $msg | pbcopy Write-Host 'copied to clipboard' That’s it! I’m sure you can implement this in your favourite scripting language\nReferences  Maven Git Commit ID Plugin Git Log command Introduction to Powershell - Everything you wanted to know about variable substitution in strings in Powershell Getting started with JQL - Advanced Search with JQL  ","wordCount":"505","inLanguage":"en","datePublished":"2021-06-27T12:33:00+02:00","dateModified":"2022-07-31T11:58:12+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.pieterjd.be/posts/summarize-latest-changes-in-your-codebase/"},"publisher":{"@type":"Organization","name":"pieterjd.be","logo":{"@type":"ImageObject","url":"https://www.pieterjd.be/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://www.pieterjd.be accesskey=h title="pieterjd.be (Alt + H)">pieterjd.be</a>
<div class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</div>
</div>
<ul id=menu>
<li>
<a href=https://www.pieterjd.be/posts/ title=Posts>
<span>Posts</span>
</a>
</li>
<li>
<a href=https://www.pieterjd.be/talks/ title=Talks>
<span>Talks</span>
</a>
</li>
<li>
<a href=https://www.pieterjd.be/about/ title=About>
<span>About</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<h1 class=post-title>
Summarize Latest Changes In Your Codebase
</h1>
<div class=post-meta><span title="2021-06-27 12:33:00 +0200 +0200">June 27, 2021</span>
</div>
</header>
<div class=post-content><p>You are probably familiar with this workflow</p>
<ol>
<li>work on different stories</li>
<li>pull requests are approved and merged</li>
<li>deploy changes</li>
<li>inform the team</li>
</ol>
<p>For the last part, you check your todo list to get a nice description instead of some mysterious ID. You could do this manually, but this is very time-consuming, not to mention mind-numbing. Scripts to the rescue!</p>
<h2 id=high-level-approach>High level approach<a hidden class=anchor aria-hidden=true href=#high-level-approach>#</a></h2>
<ol>
<li>
<p>Fetch the version information of the environment you want to deploy to. If not yet available, I suggest you create a version endpoint and include the commit id of the lastest commit. If you work with the Java/Maven combo, then just include the <a href=https://github.com/git-commit-id/git-commit-id-maven-plugin>Git Commit ID Maven Plugin</a></p>
</li>
<li>
<p>Get all information from all commits starting from the commit id, retrieved from the version id up till the last one. Assuming you use git (and you should!) then you can use the following command</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash> git log &lt;commitIdFromVersionEndpoint&gt;..HEAD --format<span class=o>=</span>format:<span class=s2>&#34;%s&#34;</span>
</code></pre></div></li>
<li>
<p>Do some regex magic to extract the story id, task id, &mldr;.</p>
</li>
<li>
<p>Connect to your backlog (REST, commandline, &mldr;.) to retrieve the information of the story id</p>
</li>
<li>
<p>print on the console and copy to clipboard</p>
</li>
</ol>
<h2 id=example-script>Example script<a hidden class=anchor aria-hidden=true href=#example-script>#</a></h2>
<p>As I am a fan of powershell, this was my go to language to implement this workflow.</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=c># --- helper functions ---</span>
<span class=c># get all commit messages starting from the given hash</span>
<span class=k>function</span> <span class=nb>get-commits</span><span class=p>(</span><span class=nv>$fromHash</span><span class=p>){</span>
  <span class=nv>$commits</span> <span class=p>=</span> <span class=p>&amp;</span> <span class=s2>&#34;git&#34;</span> <span class=p>@(</span><span class=s2>&#34;log&#34;</span><span class=p>,</span><span class=s2>&#34;$fromHash..HEAD&#34;</span><span class=p>,</span> <span class=s2>&#34;--format=format:&#34;&#34;%s&#34;&#34;&#34;</span><span class=p>)</span>
  <span class=k>return</span> <span class=nv>$commits</span>
<span class=p>}</span>

<span class=c># $ticketId: the Jira ticket id</span>
<span class=c># $prefix: prefix for the message that will be returned - empty by default</span>
<span class=k>function</span> <span class=nb>get-description</span><span class=p>(</span><span class=nv>$ticketId</span><span class=p>,</span><span class=nv>$prefix</span><span class=p>=</span><span class=s1>&#39;&#39;</span><span class=p>){</span>
<span class=nv>$url</span> <span class=p>=</span> <span class=s2>&#34;https://&lt;replace with jira url&gt;/rest/api/2/search?jql=issue={0}&amp;fields=summary,parent&#34;</span> <span class=o>-f</span> <span class=nv>$ticketId</span>
<span class=nv>$response</span> <span class=p>=</span> <span class=p>(</span><span class=nb>curl </span><span class=n>-u</span> <span class=p>&lt;</span><span class=n>your</span> <span class=n>credential</span><span class=p>&gt;</span> <span class=nv>$url</span> <span class=n>-s</span><span class=p>)</span> <span class=p>|</span> <span class=nb>ConvertFrom-json</span>

<span class=nv>$summary</span> <span class=p>=</span> <span class=nv>$response</span><span class=p>.</span><span class=n>issues</span><span class=p>.</span><span class=n>fields</span> <span class=p>|</span> <span class=nb>select </span><span class=n>-ExpandProperty</span> <span class=n>summary</span>
<span class=k>return</span> <span class=s2>&#34;{0}{1} - {2}&#34;</span> <span class=o>-f</span> <span class=nv>$prefix</span><span class=p>,</span><span class=nv>$ticketId</span><span class=p>,</span><span class=nv>$summary</span>
<span class=p>}</span>

<span class=c># Step 1: get version endpoint and get the hash of the latest deployed commit</span>
<span class=nv>$shortCommitId</span> <span class=p>=</span> <span class=p>(</span><span class=nb>Invoke-RestMethod</span> <span class=n>https</span><span class=err>:</span><span class=p>//&lt;</span><span class=n>replace</span> <span class=n>with</span> <span class=n>your</span> <span class=n>own</span> <span class=n>endpoint</span><span class=p>&gt;/</span><span class=n>version</span><span class=p>).</span><span class=n>gitHash</span>

<span class=c># Step 2: pull in latest changes and get all commit messages</span>
<span class=n>git</span> <span class=n>checkout</span> <span class=n>develop</span>
<span class=n>git</span> <span class=n>pull</span>
<span class=nv>$commits</span> <span class=p>=</span> <span class=nb>get-commits</span><span class=p>(</span><span class=nv>$shortCommitId</span><span class=p>)</span>

<span class=c># step 3: keep commit messages containing qntc, the Jira project key</span>
<span class=nv>$commits</span> <span class=p>=</span> <span class=nv>$commits</span> <span class=p>|?{</span><span class=nv>$_</span> <span class=o>-like</span> <span class=s1>&#39;*qntc*&#39;</span><span class=p>}</span>
<span class=c># start building the message as an array of strings</span>
<span class=nv>$msg</span> <span class=p>=</span> <span class=p>@(</span><span class=s2>&#34;Starting deploy to int. Deploy includes: &#34;</span><span class=p>)</span>
<span class=c># Step 4: retrieve the story description</span>
<span class=c># typical powershell one-liner:</span>
<span class=c># - Loop over all commits and check for QNTC prefix</span>
<span class=c># - Sort the found prefixes</span>
<span class=c># - Select the unique values</span>
<span class=c># - Fetch the story description for each unique value</span>
<span class=c># the array of the unique story description is prefixed with &#39;* &#39;, and are then appended to the $msg array</span>
<span class=nv>$msg</span> <span class=p>+=</span> <span class=p>(</span><span class=nv>$commits</span> <span class=p>|%{</span><span class=k>if</span><span class=p>(</span><span class=nv>$_</span> <span class=o>-match</span> <span class=s1>&#39;QNTC[SUP]*-\d+&#39;</span><span class=p>)</span> <span class=p>{</span><span class=nv>$Matches</span><span class=p>[</span><span class=n>0</span><span class=p>]}}</span> <span class=p>|</span> <span class=n>sort</span><span class=p>|</span> <span class=nb>select </span><span class=n>-unique</span> <span class=p>|</span> <span class=p>%{</span><span class=nb>get-description</span> <span class=nv>$_</span> <span class=s1>&#39;* &#39;</span><span class=p>})</span>
<span class=c># copy the message to the clipboard</span>
<span class=nv>$msg</span> <span class=p>|</span> <span class=n>pbcopy</span>
<span class=nb>Write-Host</span> <span class=s1>&#39;copied to clipboard&#39;</span>

</code></pre></div><p>That&rsquo;s it! I&rsquo;m sure you can implement this in your favourite scripting language</p>
<h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2>
<ul>
<li><a href=https://github.com/git-commit-id/git-commit-id-maven-plugin>Maven Git Commit ID Plugin</a></li>
<li><a href=https://git-scm.com/docs/git-log>Git Log command</a></li>
<li><a href=https://docs.microsoft.com/en-us/learn/modules/introduction-to-powershell/>Introduction to Powershell</a> - <a href="https://docs.microsoft.com/en-us/powershell/scripting/learn/deep-dives/everything-about-string-substitutions?view=powershell-7.1">Everything you wanted to know about variable substitution in strings in Powershell</a></li>
<li><a href=https://www.atlassian.com/blog/jira-software/jql-the-most-flexible-way-to-search-jira-14>Getting started with JQL</a> - <a href=https://support.atlassian.com/jira-service-management-cloud/docs/use-advanced-search-with-jira-query-language-jql/>Advanced Search with JQL</a></li>
</ul>
</div>
<footer class=post-footer>
<ul class=post-tags>
</ul>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2022 <a href=https://www.pieterjd.be>Pieter-Jan Drouillon</a></span>
<span> . </span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>